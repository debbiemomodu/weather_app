<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather</title>
  <link rel="stylesheet" href="/bootstrap-5.3.8-dist/css/bootstrap.min.css">
</head>
<body style="height:100vh;margin:0;padding:0;overflow:hidden;background-image:url('asset/image/premium_photo-1685868556097-641c237f3fa5.avif');background-size:cover;background-repeat:no-repeat;background-position:center;">

  <div class="container" style="height:100%;overflow:hidden;">
    <div class="d-flex mt-2">
      <img src="asset/image/download.png" style="width:40px;height:40px;" alt=""> 
      <b class="text-light pt-2 text-center ms-2">Weather</b>
    </div>

    <h1 id="welcome" class="text-light mt-4 text-center"></h1>

    <div class="row justify-content-center mt-5 g-2">
      <div class="col-8 col-sm-6 col-md-4">
        <input class="form-control shadow text-dark" type="text" id="searchInput" placeholder="Enter city name" style="border:none;">
      </div>
      <div class="col-4 col-sm-2 col-md-2">
        <button class="btn btn-dark w-75 h-100 ms-3" id="searchBtn">Search</button>
      </div>
    </div>

    <div id="loader" class="d-none mt-3" style="display:flex;justify-content:center;align-items:center;height:100px;">
      <div class="spinner-border text-light" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <div class="row justify-content-center text-center mt-3" id="weather" style="overflow:auto;max-height:calc(100% - 250px);"></div>
  </div>

  <script>
    const btn = document.getElementById("searchBtn");
    const list = document.getElementById("weather");
    const loader = document.getElementById("loader");
    const apiKey = "b368c2a3665140749f9143953251709";

    document.getElementById("welcome").innerText = "Welcome " + localStorage.getItem("name");

    function showLoader() {
      loader.classList.remove("d-none");
      loader.classList.add("d-flex");
    }

    function hideLoader() {
      loader.classList.remove("d-flex");
      loader.classList.add("d-none");
    }

    btn.addEventListener("click", function () {
      const input = document.getElementById("searchInput").value;

      if (!input) {
        alert("Please enter a city");
        return;
      }

      list.innerHTML = "";
      showLoader();

      fetch(`https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${input}&aqi=no`)
        .then(res => res.json())
        .then(data => {
          if (data.error) {
            list.innerHTML = `<p class="text-danger">${data.error.message}</p>`;
            return;
          }

          list.innerHTML = `
            <div class="card shadow col-10 col-sm-6 col-md-4 bg-dark text-light p-3">
              <p><b>Time:</b> ${data.location.localtime}</p>
              <p><b>Temperature:</b> ${data.current.temp_c}°C</p>
              <p><b>Humidity:</b> ${data.current.humidity}%</p>
              <p><b>Dewpoint:</b> ${data.current.dewpoint_f}°F</p>
            </div>
          `;
        })
        .catch(error => {
          console.error("Error fetching weather:", error);
        })
        .finally(() => {
          hideLoader();
        });
    });
  </script>
</body>
</html>
